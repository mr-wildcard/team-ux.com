---
import { HTMLAttributes } from "astro/types";

type PNGSrc = string;
type AvifSrc = string;
type WebPSrc = string;

interface Props extends HTMLAttributes<"img"> {
  srcSet: [AvifSrc, WebPSrc, PNGSrc];
  alt: string;
  width?: number;
  height?: number;
  loading?: string;
}

const { srcSet, loading = "lazy", ...props } = Astro.props;

const [png, avif, webp] = srcSet;
---

<picture>
  {avif && <source srcset={avif} type="image/avif" />}
  {webp && <source srcset={webp} type="image/webp" />}

  <img {...props} src={png} loading={loading} decoding="async" />
</picture>
