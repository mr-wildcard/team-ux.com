---
import { HTMLAttributes } from "astro/types";
type PNGSrc = string;
type AvifSrc = string;
type WebPSrc = string;

interface Props extends HTMLAttributes<"img"> {
  srcSet: [AvifSrc, WebPSrc, PNGSrc];
  alt: string;
  width?: `${number}px`;
  height?: `${number}px`;
}

const { srcSet, ...props } = Astro.props;

const [png, avif, webp] = srcSet;

// Specific hack for Github Pages
const basePath = process.env.GITHUB_ACTION ? "/team-ux.com/" : "";
---

<picture>
  {avif && <source srcset={`${basePath}${avif}`} type="image/avif" />}
  {webp && <source srcset={`${basePath}${webp}`} type="image/webp" />}

  <img {...props} src={`${basePath}${png}`} loading="lazy" decoding="async" />
</picture>
